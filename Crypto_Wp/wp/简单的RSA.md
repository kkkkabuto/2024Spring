# 题目
```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
from Crypto.Util.number import *
import random
flag=b'flag{******************}'
n = 2 ** 256
flaglong=bytes_to_long(flag) # 明文转为长整数
m = random.randint(2, n-1) | 1 #随机生成一个2到2^256-1的奇数，下面给了m
c = pow(m, flaglong, n) # c = m ^ flaglong % n
print('m = ' + str(m))
print('c = ' + str(c))

# m = 73964803637492582853353338913523546944627084372081477892312545091623069227301
# c = 21572244511100216966799370397791432119463715616349800194229377843045443048821
```

# 解题思路
使用离散对数解密
即找到一个整数k，使得 (m^k) % n = c，其中 m 是明文，n 是模数，c 是密文
求出k就是flag（flag即是加密使用的密钥）

# 解题脚本
```python
m = 73964803637492582853353338913523546944627084372081477892312545091623069227301
c = 21572244511100216966799370397791432119463715616349800194229377843045443048821
n = 2 ** 256
import sympy
flag=sympy.discrete_log(n,c,m)
import binascii
# hex(flag):将flag转换成16进制字符串
# hex(flag)[2:]:去掉字符串前面的0x
# binascii.unhexlify(hex(flag)[2:])：16进制字符串转字节串
print(binascii.unhexlify(hex(flag)[2:]))
```

# 总结
算是一个简单的RSA加密
给了c，m，n，只需要求幂指数就得到flag
重点是discrete_log方法运用和后面的字符串转换


## 类似题型
- [网鼎杯 2020 青龙组]you_raise_me_up
- 题目
```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
from Crypto.Util.number import *
import random

n = 2 ** 512
m = random.randint(2, n-1) | 1
c = pow(m, bytes_to_long(flag), n)
print 'm = ' + str(m)
print 'c = ' + str(c)

# m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075
# c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499

```

## 解题脚本
```python
m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075
c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499
n = 2 ** 512
import sympy
flag=sympy.discrete_log(n,c,m)
import binascii
# hex(flag):将flag转换成16进制字符串
# hex(flag)[2:]:去掉字符串前面的0x
# binascii.unhexlify(hex(flag)[2:])：16进制字符串转字节串
print(binascii.unhexlify(hex(flag)[2:]))

```